---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
This document assumes that you have the data downloaded and unzipped into your working directory.

## Loading and preprocessing the data
Begin by reading in the data. I have left the date variable in factor format in order to more easily separate the steps by date in the next step.
```{r, echo=TRUE}
activity<-read.csv("activity.csv")

```

## What is mean total number of steps taken per day?

First divide the steps by day.  Then sum each day.  Finally, make a histogram of the total number of steps each day.
```{r, echo=TRUE}
split.steps<-split(activity$steps, activity$date)
steps.per.day<-sapply(split.steps, sum)
hist(steps.per.day, col="steelblue", main="Histogram of Total Steps per Day", xlab="Steps per Day")
```

Calculate the mean and median of the total number of steps per day.
```{r, echo=TRUE}
    paste0("Mean = ", round(mean(steps.per.day, na.rm=TRUE), 2)); paste0("Median = ", median(steps.per.day, na.rm=TRUE))

```
## What is the average daily activity pattern?

First split the steps data into sections by interval, so that the first interval of each day is in one group, the second interval of each day is in the second group, etc.  Then take the mean of each interval across all days.  Finally, plot the time series of the results.
```{r, echo=TRUE}
    split.by.interval<-split(activity$steps, as.factor(activity$interval))
    mean.per.interval<-sapply(split.by.interval, mean, na.rm=TRUE)
    plot(mean.per.interval~names(mean.per.interval), type="l", main="Time Series of Average Steps in each Interval", xlab="Interval", ylab="Mean Number of Steps")
   
```

Now find the interval that has the highest average number of steps.
```{r, echo=TRUE}
    paste0("The interval with the maximum average number of steps is interval ", names(mean.per.interval[mean.per.interval == max(mean.per.interval)]))

```

## Imputing missing values

First count the number of missing values.
```{r, echo=TRUE, results='asis'}
sum(!complete.cases(activity))

```

Since most of the missing values are entire missing days of data, I have chosen to replace them with the mean across all days of the interval in which they appear rather than the mean of that day.

First, make a copy of the data frame.  Then replace each N/A with the average for the interval in which it appears

```{r, echo=TRUE}
   activity.complete<-activity
    
    for (i in 1:length(activity$steps)){
        
        if (is.na(activity.complete$steps[i])) {
            interval<-as.character(activity.complete$interval[i])
            activity.complete$steps[i]<-mean.per.interval[interval]
        }
    }
```


Now, we recreate the analysis from part 1 on this new data frame and compare it to the old results:

First, compare histograms of the total number of steps each day.
```{r, echo=TRUE, fig.width=10}
split.complete.steps<-split(activity.complete$steps, activity$date)
complete.steps.per.day<-sapply(split.complete.steps, sum)
par(mfrow=c(1,2))
hist(complete.steps.per.day, col="steelblue", main="Histogram of Total Steps per Day (N/As Imputed)", xlab="Steps per Day")
hist(steps.per.day, col="steelblue", main="Histogram of Total Steps per Day", xlab="Steps per Day", ylim=c(0, 35))
```
We can see here that the histogram is generally a similar shape, but that the middle bin (or bar, if you prefer) is higher/ more frequent.

Now we compare the means and medians of the two distributions.
```{r, echo=TRUE}
paste0("Mean (ignore NA's) = ", round(mean(steps.per.day, na.rm=TRUE), 2)); paste0("Mean (impute NA's) = ", round(mean(complete.steps.per.day, na.rm=TRUE), 2))
paste0("Median (ignore NAs) = ", median(steps.per.day, na.rm=TRUE));paste0("Median (impute NA's) = ", round(median(complete.steps.per.day, na.rm=TRUE), 2))

```

The mean has not changed at all, while the median has been shifted to match the mean.  This is because of the pattern of the NAs combined with the method used to replace them.  The NAs only existed as entire days.  Therefore, when they were each replaced with the average value of their interval, the total number of steps in those previously NA days was exactly equal to the average number of total steps per day.  Adding more days that have exactly the mean number of steps does not change the mean but it can change the median.  In this case, it moved the median to one of the days with exactly the mean number of steps.

## Are there differences in activity patterns between weekdays and weekends?
